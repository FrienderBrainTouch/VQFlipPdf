<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF 플립북</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 헤더 스타일 */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .book-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .book-btn {
            padding: 12px 24px;
            font-size: 1.1rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .book-btn.active {
            background: #4CAF50;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .book-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        /* 기능 버튼들 */
        .function-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .function-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .print-btn {
            background: #2196F3;
            color: white;
        }

        .download-btn {
            background: #4CAF50;
            color: white;
        }

        .book-download-btn {
            background: #FF9800;
            color: white;
        }

        .function-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* 플립북 컨테이너 */
        .flipbook-container {
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
            margin: 0 auto;
        }

        .book {
            position: relative;
            width: 370px;
            height: 500px;
            transform-style: preserve-3d;
            transition: transform 0.5s;
        }

        .book.mobile {
            width: 320px;
            height: 450px;
        }

        /* 페이지 스타일 */
        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-origin: left center;
            transition: all 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .page.flipped {
            transform: rotateY(-180deg);
        }

        /* 페이지 위치 조정 */
        .page:nth-child(odd) {
            left: 0;
        }

        .page:nth-child(even) {
            left: 0;
        }

        /* 페이지 넘김 효과 개선 */
        .page.right-page {
            transform: translateX(50%);
        }

        .page.left-page {
            transform: translateX(-50%);
        }

        .page-content {
            width: 100%;
            height: 100%;
            position: relative;
            background: white;
        }

        .page-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 인터랙티브 이미지 */
        .interactive-image {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            border-radius: 8px;
        }

        .interactive-image:hover {
            border-color: #2196F3;
            transform: scale(1.05);
        }

        .interactive-image img {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .interactive-image:hover img {
            opacity: 1;
        }

        .interactive-image video {
            opacity: 1;
        }

        /* 표지 페이지 애니메이션 */
        .cover-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .cover-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease-out, filter 0.3s ease-out;
        }

        .cover-main-image {
            width: 320px;
            height: 320px;
            object-fit: contain;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            z-index: 2;
            position: relative;
        }

        .cover-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            z-index: 2;
            position: relative;
        }

        .cover-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            z-index: 2;
            position: relative;
        }

        /* 네비게이션 */
        .navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            background: white;
            color: #333;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* 모달 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #000;
        }

        .modal-media {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .book-selector {
                flex-direction: column;
                align-items: center;
            }

            .function-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }

            .book {
                width: 320px;
                height: 450px;
            }

            .cover-main-image {
                width: 250px;
                height: 250px;
            }

            .cover-title {
                font-size: 1.5rem;
            }

            .cover-subtitle {
                font-size: 1rem;
            }

            /* 모바일에서 인터랙티브 이미지 크기 조정 */
            .interactive-image {
                transform: scale(0.9);
            }

            .interactive-image img,
            .interactive-image video {
                max-width: 80% !important;
            }
        }

        /* 태블릿 반응형 */
        @media (min-width: 769px) and (max-width: 1024px) {
            .book {
                width: 350px;
                height: 480px;
            }

            .interactive-image {
                transform: scale(0.95);
            }
        }

        /* 대형 화면 반응형 */
        @media (min-width: 1025px) {
            .book {
                width: 370px;
                height: 500px;
            }
        }

        /* 로딩 애니메이션 */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* 페이지 넘김 효과 */
        .page-shadow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.1), transparent);
            pointer-events: none;
            z-index: 1;
        }

        .page.flipped .page-shadow {
            background: linear-gradient(to left, rgba(0, 0, 0, 0.1), transparent);
        }

        /* 3D 모델링 컨테이너 */
        .model-3d-container {
            position: absolute;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            cursor: grab;
            transition: transform 0.1s ease;
        }

        .model-3d-container:active {
            cursor: grabbing;
        }

        .model-3d {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
        }

        /* 3D 모델의 각 면 */
        .model-face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-sizing: border-box;
        }

        .model-face.front {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            transform: translateZ(100px);
        }

        .model-face.back {
            background: linear-gradient(45deg, #4834d4, #686de0);
            transform: translateZ(-100px) rotateY(180deg);
        }

        .model-face.right {
            background: linear-gradient(45deg, #00d2d3, #54a0ff);
            transform: translateX(100px) rotateY(90deg);
        }

        .model-face.left {
            background: linear-gradient(45deg, #ff9ff3, #f368e0);
            transform: translateX(-100px) rotateY(-90deg);
        }

        .model-face.top {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            transform: translateY(-100px) rotateX(90deg);
        }

        .model-face.bottom {
            background: linear-gradient(45deg, #fd79a8, #e84393);
            transform: translateY(100px) rotateX(-90deg);
        }

        /* 3D 모델 제어 버튼 */
        .model-controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .model-control-btn {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .model-control-btn:hover {
            background: white;
            transform: translateY(-2px);
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <!-- 책 선택 버튼 -->
            <div class="book-selector">
                <button class="book-btn active" id="friender-btn" data-book="friender">Friender 프로젝트</button>
                <button class="book-btn" id="vq-btn" data-book="vq">VQ 프로젝트</button>
            </div>

            <!-- 기능 버튼들 -->
            <div class="function-buttons">
                <button class="function-btn book-download-btn" id="friender-book-btn">
                    📚 Friender 책자
                </button>
                <button class="function-btn book-download-btn" id="vq-book-btn">
                    📚 VQ 책자
                </button>
                <button class="function-btn print-btn" id="print-btn">
                    🖨️ 프린트
                </button>
                <button class="function-btn download-btn" id="download-btn">
                    📥 PDF 다운로드
                </button>
            </div>
        </div>

        <!-- 플립북 컨테이너 -->
        <div class="flipbook-container">
            <div class="book" id="book">
                <!-- 페이지들이 JavaScript로 동적 생성됩니다 -->
            </div>
        </div>

        <!-- 네비게이션 -->
        <div class="navigation">
            <button class="nav-btn" id="prevBtn">◀ 이전</button>
            <span id="pageInfo" style="color: white; font-weight: bold; padding: 10px 20px;">1 / 8</span>
            <button class="nav-btn" id="nextBtn">다음 ▶</button>
        </div>
    </div>

    <!-- 모달 -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // 전역 변수
        let currentBook = 'friender';
        let currentPage = 0;
        let totalPages = 8;
        let bookData = {};
        let isMobile = window.innerWidth < 768;

        // Friender 환경 관련 GIF 매핑
        const frienderGifMapping = {
            1: './public/interacivefile/FrienderFile/1-탄소-중립을-통해-지구촌-기후변화를-예방.gif',
            2: './public/interacivefile/FrienderFile/2-친환경-에너지-자립마을-만들기.gif',
            3: './public/interacivefile/FrienderFile/3-탄소-중립-실천.gif',
            4: './public/interacivefile/FrienderFile/4-똑똑한-재활용-쓰레기-분리배출-실천.gif',
            5: './public/interacivefile/FrienderFile/5-에너지가-가정에-오기까지의-여정.gif',
            6: './public/interacivefile/FrienderFile/6-해양-오염-구조-탐사대-체험.gif'
        };

        // 책 데이터 정의
        const frienderData = {
            name: 'Friender 프로젝트',
            totalPages: 8,
            pdfPath: './public/func-file/FrienderFile/프랜더-소개-책자.pdf',
            pages: [
                {
                    id: 'cover',
                    image: './public/Pdf-img/Friender/1.jpg',
                    isCover: true,
                    interactiveElements: []
                },
                {
                    id: 1,
                    image: './public/Pdf-img/Friender/2.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/2-1.png',
                            position: { top: '3%', left: '5%', width: '100%', maxWidth: '345px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/2-2.png',
                            position: { top: '25%', left: '3%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/2-3.png',
                            position: { bottom: '0%', right: '0%', width: '100%', maxWidth: '355px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 2,
                    image: './public/Pdf-img/Friender/3.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/3-1.png',
                            position: { top: '7%', left: '2%', width: '100%', maxWidth: '353px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/3-2.png',
                            position: { top: '38%', right: '2%', width: '100%', maxWidth: '354px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/3-3.png',
                            position: { bottom: '0%', left: '3%', width: '100%', maxWidth: '351px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 3,
                    image: './public/Pdf-img/Friender/4.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/4-1.png',
                            position: { top: '0%', left: '7%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/4-2.png',
                            position: { top: '22%', right: '2%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/4-3.png',
                            position: { bottom: '39%', left: '7%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/4-4.png',
                            position: { bottom: '3%', right: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-1.png',
                            position: { top: '12%', left: '9%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-2.png',
                            position: { top: '12%', left: '23.5%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-3.png',
                            position: { top: '12%', left: '38%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-4.png',
                            position: { top: '12%', left: '52%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-5.png',
                            position: { top: '12%', left: '67%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/environ-6.png',
                            position: { top: '12%', left: '81%', width: '50px', maxWidth: '50px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 4,
                    image: './public/Pdf-img/Friender/5.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/5-1.png',
                            position: { top: '0%', left: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/5-2.png',
                            position: { top: '33%', left: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/5-3.png',
                            position: { bottom: '3%', right: '10%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'video',
                            src: './public/interacivefile/FrienderFile/BlockCoding-VR.mp4',
                            position: { top: '6%', left: '22%', width: '200px', maxWidth: '157px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 5,
                    image: './public/Pdf-img/Friender/6.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/6-1.png',
                            position: { top: '0%', left: '9%', width: '100%', maxWidth: '305px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/6-2.png',
                            position: { top: '12%', left: '6%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/6-3.png',
                            position: { bottom: '27%', right: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/6-4.png',
                            position: { bottom: '3%', left: '7%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 6,
                    image: './public/Pdf-img/Friender/7.jpg',
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/7-1.png',
                            position: { top: '0%', left: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/7-2.png',
                            position: { top: '11%', right: '8%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/7-3.png',
                            position: { bottom: '39%', left: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        },
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/7-4.png',
                            position: { bottom: '4%', right: '7%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        }
                    ]
                },
                {
                    id: 'last',
                    image: './public/Pdf-img/Friender/8.jpg',
                    isLast: true,
                    interactiveElements: [
                        {
                            type: 'image',
                            src: './public/interacivefile/FrienderFile/section-img/8-1.png',
                            position: { bottom: '1%', left: '0%', width: '100%', maxWidth: '340px' },
                            clickAction: 'modal'
                        }
                    ]
                }
            ]
        };

        const vqData = {
            name: 'VQ 프로젝트',
            totalPages: 24,
            pdfPath: './public/func-file/VQFile/(주)브이큐스튜디오_소개 카달로그.pdf',
            pages: [
                {
                    id: 'cover',
                    image: './public/Pdf-img/VQ/1.png',
                    isCover: true,
                    interactiveElements: []
                }
            ]
        };

        // VQ 페이지 데이터 동적 생성
        for (let i = 2; i <= 23; i++) {
            vqData.pages.push({
                id: i - 1,
                image: `./public/Pdf-img/VQ/${i}.png`,
                interactiveElements: []
            });
        }

        vqData.pages.push({
            id: 'last',
            image: './public/Pdf-img/VQ/24.png',
            isLast: true,
            interactiveElements: []
        });

        // VQ 페이지들에 인터랙티브 요소 추가
        vqData.pages[1].interactiveElements = [
            {
                type: 'image',
                src: './public/interacivefile/VQFile/sectionimg/2-1.png',
                position: { top: '17%', left: '9%', width: '100%', maxWidth: '300px' },
                clickAction: 'modal'
            },
            {
                type: 'image',
                src: './public/interacivefile/VQFile/sectionimg/2-2.png',
                position: { top: '48%', left: '8%', width: '100%', maxWidth: '320px' },
                clickAction: 'modal'
            },
            {
                type: 'image',
                src: './public/interacivefile/VQFile/sectionimg/2-3.png',
                position: { bottom: '8%', left: '9%', width: '100%', maxWidth: '320px' },
                clickAction: 'modal'
            }
        ];

        // 추가 VQ 페이지들에 인터랙티브 요소 추가
        vqData.pages[18].interactiveElements = [
            {
                type: 'video',
                src: './public/interacivefile/VQFile/19-1-video.mp4',
                position: { top: '10%', left: '25%', width: '175px', maxWidth: '175px' },
                clickAction: 'modal'
            }
        ];

        // 초기화
        function init() {
            bookData = frienderData;
            totalPages = bookData.totalPages;
            currentPage = 0;
            renderBook();
            updateNavigation();
            startCoverAnimation();
            setupEventListeners();
        }

        // 이벤트 리스너 설정
        function setupEventListeners() {
            document.getElementById('friender-btn').addEventListener('click', function () {
                switchBook('friender');
            });

            document.getElementById('vq-btn').addEventListener('click', function () {
                switchBook('vq');
            });

            document.getElementById('friender-book-btn').addEventListener('click', function () {
                downloadBook('friender');
            });
            document.getElementById('vq-book-btn').addEventListener('click', function () {
                downloadBook('vq');
            });

            document.getElementById('print-btn').addEventListener('click', printPDF);
            document.getElementById('download-btn').addEventListener('click', downloadPDF);
            document.getElementById('prevBtn').addEventListener('click', previousPage);
            document.getElementById('nextBtn').addEventListener('click', nextPage);
            document.getElementById('closeModal').addEventListener('click', closeModal);

            document.getElementById('modal').addEventListener('click', function (e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            document.addEventListener('keydown', function (e) {
                if (e.key === 'ArrowLeft') {
                    previousPage();
                } else if (e.key === 'ArrowRight') {
                    nextPage();
                }
            });

            window.addEventListener('resize', function () {
                const wasMobile = isMobile;
                isMobile = window.innerWidth < 768;

                if (wasMobile !== isMobile) {
                    renderBook();
                }
            });
        }

        // 책 렌더링
        function renderBook() {
            const bookElement = document.getElementById('book');
            bookElement.innerHTML = '';

            if (isMobile) {
                bookElement.classList.add('mobile');
            } else {
                bookElement.classList.remove('mobile');
            }

            bookData.pages.forEach((page, index) => {
                const pageElement = createPageElement(page, index);
                bookElement.appendChild(pageElement);
            });

            if (currentPage === 0) {
                for (let i = 0; i < totalPages; i++) {
                    const pageElement = document.getElementById(`page-${i}`);
                    if (pageElement) {
                        if (i === 0) {
                            pageElement.style.display = 'block';
                            pageElement.style.transform = 'translateX(0)';
                            pageElement.classList.add('left-page');
                        } else {
                            pageElement.style.display = 'none';
                        }
                    }
                }
            }
        }

        // 페이지 요소 생성
        function createPageElement(page, index) {
            const pageDiv = document.createElement('div');
            pageDiv.className = 'page';
            pageDiv.id = `page-${index}`;
            pageDiv.style.zIndex = totalPages - index;

            const pageContent = document.createElement('div');
            pageContent.className = 'page-content';

            if (page.isCover) {
                pageContent.className += ' cover-page';
                if (bookData.name === 'Friender 프로젝트') {
                    const coverBackground = document.createElement('img');
                    coverBackground.src = page.image;
                    coverBackground.alt = 'Cover';
                    coverBackground.className = 'cover-background';
                    pageContent.appendChild(coverBackground);

                    const overlayDiv = document.createElement('div');
                    overlayDiv.className = 'absolute inset-0 flex items-center justify-center';

                    const mainImage = document.createElement('img');
                    mainImage.src = './public/interacivefile/FrienderFile/main.png';
                    mainImage.alt = 'Main';
                    mainImage.className = 'cover-main-image';
                    mainImage.id = 'cover-main-image';
                    mainImage.style.cssText = 'width: 1px; height: 1px; opacity: 0; transform: rotate(0deg); object-fit: contain; transition: transform 0.1s linear;';
                    overlayDiv.appendChild(mainImage);
                    pageContent.appendChild(overlayDiv);

                    const textContainer = document.createElement('div');
                    textContainer.id = 'cover-text-container';
                    textContainer.className = 'absolute';
                    textContainer.style.cssText = 'display: none; flex-direction: column; align-items: flex-start; gap: 10px; z-index: 10;';

                    const titleImg = document.createElement('img');
                    titleImg.src = './public/interacivefile/FrienderFile/title.png';
                    titleImg.alt = 'Title';
                    titleImg.id = 'cover-title-img';
                    titleImg.style.cssText = 'width: 256px; height: auto; opacity: 0; transform: translateY(20px); transition: opacity 0.3s ease-out, transform 0.3s ease-out;';
                    textContainer.appendChild(titleImg);

                    const subtitleImg = document.createElement('img');
                    subtitleImg.src = './public/interacivefile/FrienderFile/subtitle.png';
                    subtitleImg.alt = 'Subtitle';
                    subtitleImg.id = 'cover-subtitle-img';
                    subtitleImg.style.cssText = 'width: 160px; height: auto; opacity: 0; transform: translateY(20px); transition: opacity 0.3s ease-out, transform 0.3s ease-out;';
                    textContainer.appendChild(subtitleImg);

                    pageContent.appendChild(textContainer);
                } else {
                    const coverBackground = document.createElement('img');
                    coverBackground.src = page.image;
                    coverBackground.alt = 'Cover';
                    coverBackground.className = 'cover-background';
                    pageContent.appendChild(coverBackground);
                }
            } else {
                const pageImage = document.createElement('img');
                pageImage.src = page.image;
                pageImage.alt = page.id === 'last' ? 'Last Page' : `Page ${page.id}`;
                pageImage.className = 'page-image';
                pageContent.appendChild(pageImage);

                page.interactiveElements.forEach((element, elementIndex) => {
                    const interactiveDiv = createInteractiveElement(element, elementIndex);
                    pageContent.appendChild(interactiveDiv);
                });
            }

            const shadow = document.createElement('div');
            shadow.className = 'page-shadow';
            pageContent.appendChild(shadow);

            pageDiv.appendChild(pageContent);
            return pageDiv;
        }

        // 반응형 이미지 크기 계산 함수
        function getResponsiveImageSize(baseSize, isMobile) {
            return isMobile ? baseSize * 0.8 : baseSize;
        }

        // 반응형 이미지 위치 계산 함수
        function getResponsiveImagePosition(baseConfig, isMobile) {
            const scale = isMobile ? 0.9 : 1;
            const result = {
                ...baseConfig,
                width: `${parseFloat(baseConfig.width) * scale}%`,
                maxWidth: `${getResponsiveImageSize(parseInt(baseConfig.maxWidth), isMobile)}px`
            };

            if (baseConfig.top) result.top = baseConfig.top;
            if (baseConfig.left) result.left = baseConfig.left;
            if (baseConfig.bottom) result.bottom = baseConfig.bottom;
            if (baseConfig.right) result.right = baseConfig.right;

            return result;
        }

        // 인터랙티브 요소 생성
        function createInteractiveElement(element, index) {
            const div = document.createElement('div');
            div.className = 'interactive-image';

            const responsivePosition = getResponsiveImagePosition(element.position, isMobile);

            div.style.position = 'absolute';

            if (responsivePosition.top) {
                div.style.top = responsivePosition.top;
            }
            if (responsivePosition.left) {
                div.style.left = responsivePosition.left;
            }
            if (responsivePosition.bottom) {
                div.style.bottom = responsivePosition.bottom;
            }
            if (responsivePosition.right) {
                div.style.right = responsivePosition.right;
            }

            div.style.width = responsivePosition.width;
            div.style.maxWidth = responsivePosition.maxWidth;

            if (element.type === 'image') {
                const img = document.createElement('img');
                img.src = element.src;
                img.alt = `Interactive ${index + 1}`;
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'contain';
                img.style.opacity = '0';
                div.appendChild(img);
            } else if (element.type === 'video') {
                const video = document.createElement('video');
                video.src = element.src;
                video.controls = true;
                video.muted = true;
                video.loop = true;
                video.style.width = '100%';
                video.style.height = '100%';
                video.style.objectFit = 'contain';
                video.style.opacity = '1';
                div.appendChild(video);
            }

            div.addEventListener('click', function (e) {
                e.preventDefault();
                e.stopPropagation();
                if (element.clickAction === 'modal') {
                    showModal(element.src, element.type);
                }
            });

            return div;
        }

        // 페이지 넘기기
        function flipToPage(pageIndex) {
            const maxPageIndex = Math.ceil((totalPages - 1) / 2);
            if (pageIndex < 0 || pageIndex > maxPageIndex) return;

            for (let i = 0; i < totalPages; i++) {
                const pageElement = document.getElementById(`page-${i}`);
                if (pageElement) {
                    pageElement.style.display = 'none';
                    pageElement.style.visibility = 'hidden';
                    pageElement.style.opacity = '0';
                    pageElement.style.pointerEvents = 'none';
                    pageElement.classList.remove('flipped', 'left-page', 'right-page');
                    pageElement.style.transform = '';
                    pageElement.style.zIndex = '0';
                }
            }

            currentPage = pageIndex;
            updateNavigation();

            for (let i = 0; i < totalPages; i++) {
                const pageElement = document.getElementById(`page-${i}`);
                if (pageElement) {
                    if (pageIndex === 0) {
                        if (i === 0) {
                            pageElement.style.display = 'block';
                            pageElement.style.visibility = 'visible';
                            pageElement.style.opacity = '1';
                            pageElement.style.pointerEvents = 'auto';
                            pageElement.style.zIndex = totalPages;
                            pageElement.style.transform = 'translateX(0)';
                            pageElement.classList.add('left-page');
                        } else {
                            pageElement.style.display = 'none';
                            pageElement.style.visibility = 'hidden';
                            pageElement.style.opacity = '0';
                            pageElement.style.pointerEvents = 'none';
                        }
                    } else if (pageIndex === Math.ceil((totalPages - 1) / 2)) {
                        if (i === totalPages - 1) {
                            pageElement.style.display = 'block';
                            pageElement.style.visibility = 'visible';
                            pageElement.style.opacity = '1';
                            pageElement.style.pointerEvents = 'auto';
                            pageElement.style.zIndex = totalPages;
                            pageElement.style.transform = 'translateX(0)';
                            pageElement.classList.add('left-page');
                        } else {
                            pageElement.style.display = 'none';
                            pageElement.style.visibility = 'hidden';
                            pageElement.style.opacity = '0';
                            pageElement.style.pointerEvents = 'none';
                        }
                    } else {
                        const leftPageIndex = pageIndex * 2 - 1;
                        const rightPageIndex = leftPageIndex + 1;

                        if (i === leftPageIndex) {
                            pageElement.style.display = 'block';
                            pageElement.style.visibility = 'visible';
                            pageElement.style.opacity = '1';
                            pageElement.style.pointerEvents = 'auto';
                            pageElement.style.zIndex = totalPages;
                            pageElement.style.transform = 'translateX(-50%)';
                            pageElement.classList.add('left-page');
                        } else if (i === rightPageIndex && rightPageIndex < totalPages - 1) {
                            pageElement.style.display = 'block';
                            pageElement.style.visibility = 'visible';
                            pageElement.style.opacity = '1';
                            pageElement.style.pointerEvents = 'auto';
                            pageElement.style.zIndex = totalPages - 1;
                            pageElement.style.transform = 'translateX(50%)';
                            pageElement.classList.add('right-page');
                        } else {
                            pageElement.style.display = 'none';
                            pageElement.style.visibility = 'hidden';
                            pageElement.style.opacity = '0';
                            pageElement.style.pointerEvents = 'none';
                        }
                    }
                }
            }

            if (pageIndex === 0) {
                startCoverAnimation();
            }
        }

        // 다음 페이지
        function nextPage() {
            const maxPageIndex = Math.ceil((totalPages - 1) / 2);
            if (currentPage < maxPageIndex) {
                flipToPage(currentPage + 1);
            }
        }

        // 이전 페이지
        function previousPage() {
            if (currentPage > 0) {
                flipToPage(currentPage - 1);
            }
        }

        // 네비게이션 업데이트
        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const pageInfo = document.getElementById('pageInfo');

            const maxPageIndex = Math.ceil((totalPages - 1) / 2);

            prevBtn.disabled = currentPage === 0;
            nextBtn.disabled = currentPage === maxPageIndex;
            pageInfo.textContent = `${currentPage + 1} / ${maxPageIndex + 1}`;
        }

        // 표지 애니메이션 변수들
        let animationRef = null;
        let isMainImageAnimating = false;
        let mainImageSize = 1;
        let mainImageRotation = 0;
        let mainImageOpacity = 0;
        let titleOpacity = 0;
        let subtitleOpacity = 0;
        let backgroundScale = 1.2;
        let backgroundBlur = 0;

        // 화려한 표지 애니메이션 함수
        function animateCover(duration) {
            const startTime = performance.now();

            const animate = (currentTime) => {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                if (progress <= 0.3) {
                    const bgProgress = progress / 0.3;
                    backgroundScale = 1.2 - (0.2 * bgProgress);
                    backgroundBlur = 5 * bgProgress;
                    updateBackgroundAnimation();
                }

                if (progress >= 0.2 && progress <= 0.5) {
                    const imgProgress = (progress - 0.2) / 0.3;
                    mainImageOpacity = imgProgress;
                    mainImageRotation = 360 * imgProgress;
                    mainImageSize = 1 + (319 * imgProgress);
                    updateMainImageAnimation();
                }

                if (progress >= 0.5 && progress <= 0.8) {
                    const sizeProgress = (progress - 0.5) / 0.3;
                    mainImageSize = 320 + (0 * sizeProgress);
                    mainImageRotation = 360 - (360 * sizeProgress);
                    updateMainImageAnimation();
                }

                if (progress >= 0.7 && progress <= 1) {
                    const textProgress = (progress - 0.7) / 0.3;
                    titleOpacity = textProgress;
                    subtitleOpacity = textProgress;
                    updateTextAnimation();
                }

                if (progress >= 1) {
                    mainImageRotation = 0;
                    updateMainImageAnimation();
                }

                if (progress < 1) {
                    animationRef = requestAnimationFrame(animate);
                }
            };

            animationRef = requestAnimationFrame(animate);
        }

        // 배경 애니메이션 업데이트
        function updateBackgroundAnimation() {
            const backgroundImg = document.querySelector('.cover-background');
            if (backgroundImg) {
                backgroundImg.style.transform = `scale(${backgroundScale})`;
                backgroundImg.style.filter = `blur(${backgroundBlur}px)`;
            }
        }

        // 메인 이미지 애니메이션 업데이트
        function updateMainImageAnimation() {
            const mainImage = document.getElementById('cover-main-image');
            const textContainer = document.getElementById('cover-text-container');

            if (mainImage) {
                mainImage.style.width = `${mainImageSize}px`;
                mainImage.style.height = `${mainImageSize}px`;
                mainImage.style.opacity = mainImageOpacity;
                mainImage.style.transform = `rotate(${mainImageRotation}deg)`;
            }

            if (textContainer && isMainImageAnimating && mainImageSize > 50) {
                textContainer.style.display = 'flex';
                const containerWidth = mainImageSize * 0.8;
                const containerHeight = mainImageSize * 0.5;

                textContainer.style.left = `calc(50% - ${containerWidth / 2}px)`;
                textContainer.style.top = `calc(50% - ${containerHeight / 2}px)`;
            }
        }

        // 텍스트 애니메이션 업데이트
        function updateTextAnimation() {
            const titleImg = document.getElementById('cover-title-img');
            const subtitleImg = document.getElementById('cover-subtitle-img');

            if (titleImg) {
                titleImg.style.width = `${mainImageSize * 0.8}px`;
                titleImg.style.height = 'auto';
                titleImg.style.opacity = titleOpacity;
                titleImg.style.transform = `translateY(${20 - (titleOpacity * 20)}px)`;
            }

            if (subtitleImg) {
                subtitleImg.style.width = `${mainImageSize * 0.5}px`;
                subtitleImg.style.height = 'auto';
                subtitleImg.style.opacity = subtitleOpacity;
                subtitleImg.style.transform = `translateY(${20 - (subtitleOpacity * 20)}px)`;
            }
        }

        // 표지 애니메이션 시작
        function startCoverAnimation() {
            isMainImageAnimating = false;
            mainImageSize = 1;
            mainImageRotation = 0;
            mainImageOpacity = 0;
            titleOpacity = 0;
            subtitleOpacity = 0;
            backgroundScale = 1.2;
            backgroundBlur = 0;

            if (bookData.name === 'Friender 프로젝트') {
                setTimeout(() => {
                    isMainImageAnimating = true;
                    animateCover(3000);
                }, 1000);
            }
        }

        // 모달 표시
        function showModal(src, type) {
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modalContent');

            modalContent.innerHTML = '';

            const isEnvironImage = src && src.includes('environ-');
            const is3DModelImage = src && src.includes('3-3.png');
            let actualSrc = src;
            let actualType = type;

            if (isEnvironImage && currentBook === 'friender') {
                const environNumber = src.match(/environ-(\d+)\.png/)[1];
                actualSrc = frienderGifMapping[environNumber];
                actualType = 'image';
            } else if (is3DModelImage && currentBook === 'friender') {
                actualType = '3d-model';
            }

            if (actualType === 'video') {
                const video = document.createElement('video');
                video.src = actualSrc;
                video.controls = true;
                video.autoplay = true;
                video.className = 'modal-media';
                video.textContent = 'Your browser does not support the video tag.';
                modalContent.appendChild(video);
            } else if (actualType === '3d-model') {
                const modal3DContainer = createModal3DModel();
                modalContent.appendChild(modal3DContainer);
            } else {
                const img = document.createElement('img');
                img.src = actualSrc;
                img.alt = 'Interactive Content';
                img.className = 'modal-media';
                modalContent.appendChild(img);
            }

            modal.style.display = 'block';
        }

        // 모달용 3D 모델링 생성 함수
        function createModal3DModel() {
            const container = document.createElement('div');
            container.className = 'model-3d-container';
            container.style.width = '400px';
            container.style.height = '400px';
            container.style.margin = '0 auto';
            container.style.transform = 'none';
            container.style.position = 'relative';
            container.style.perspective = '1000px';

            const model = document.createElement('div');
            model.className = 'model-3d';
            model.id = 'modal-model-3d';
            model.style.width = '100%';
            model.style.height = '100%';
            model.style.transformStyle = 'preserve-3d';
            model.style.transition = 'transform 0.3s ease';

            const faces = [
                { class: 'front', text: '3D 모델' },
                { class: 'back', text: '뒤면' },
                { class: 'right', text: '오른쪽' },
                { class: 'left', text: '왼쪽' },
                { class: 'top', text: '위쪽' },
                { class: 'bottom', text: '아래쪽' }
            ];

            faces.forEach(face => {
                const faceDiv = document.createElement('div');
                faceDiv.className = `model-face ${face.class}`;
                faceDiv.textContent = face.text;
                faceDiv.style.fontSize = '32px';
                faceDiv.style.position = 'absolute';
                faceDiv.style.width = '100%';
                faceDiv.style.height = '100%';
                faceDiv.style.display = 'flex';
                faceDiv.style.alignItems = 'center';
                faceDiv.style.justifyContent = 'center';
                faceDiv.style.fontWeight = 'bold';
                faceDiv.style.color = 'white';
                faceDiv.style.border = '2px solid rgba(255, 255, 255, 0.3)';
                faceDiv.style.boxSizing = 'border-box';
                model.appendChild(faceDiv);
            });

            container.appendChild(model);

            const controls = document.createElement('div');
            controls.className = 'model-controls';
            controls.style.position = 'relative';
            controls.style.bottom = 'auto';
            controls.style.left = 'auto';
            controls.style.transform = 'none';
            controls.style.marginTop = '20px';
            controls.style.justifyContent = 'center';
            controls.style.display = 'flex';
            controls.style.gap = '10px';

            const resetBtn = document.createElement('button');
            resetBtn.className = 'model-control-btn';
            resetBtn.textContent = '리셋';
            resetBtn.onclick = () => resetModal3DModel();

            const autoRotateBtn = document.createElement('button');
            autoRotateBtn.className = 'model-control-btn';
            autoRotateBtn.textContent = '자동회전';
            autoRotateBtn.onclick = () => toggleModalAutoRotate();

            controls.appendChild(resetBtn);
            controls.appendChild(autoRotateBtn);
            container.appendChild(controls);

            setupModal3DModelControls(container, model);

            modalRotationX = 0;
            modalRotationY = 0;
            updateModal3DModelRotation(model);

            return container;
        }

        // 3D 모델 제어 변수들
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let modalRotationX = 0;
        let modalRotationY = 0;
        let modalAutoRotate = false;
        let modalAutoRotateInterval = null;

        // 모달용 3D 모델 마우스/터치 제어 설정
        function setupModal3DModelControls(container, model) {
            container.addEventListener('mousedown', startModalDrag);
            document.addEventListener('mousemove', modalDrag);
            document.addEventListener('mouseup', endModalDrag);

            container.addEventListener('touchstart', startModalDrag, { passive: false });
            document.addEventListener('touchmove', modalDrag, { passive: false });
            document.addEventListener('touchend', endModalDrag);

            function startModalDrag(e) {
                e.preventDefault();
                isDragging = true;

                if (e.type === 'mousedown') {
                    startX = e.clientX;
                    startY = e.clientY;
                } else if (e.type === 'touchstart') {
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                }

                container.style.cursor = 'grabbing';
            }

            function modalDrag(e) {
                if (!isDragging) return;
                e.preventDefault();

                let currentX, currentY;

                if (e.type === 'mousemove') {
                    currentX = e.clientX;
                    currentY = e.clientY;
                } else if (e.type === 'touchmove') {
                    currentX = e.touches[0].clientX;
                    currentY = e.touches[0].clientY;
                }

                const deltaX = currentX - startX;
                const deltaY = currentY - startY;

                modalRotationY += deltaX * 0.5;
                modalRotationX -= deltaY * 0.5;

                modalRotationX = Math.max(-90, Math.min(90, modalRotationX));

                updateModal3DModelRotation(model);

                startX = currentX;
                startY = currentY;
            }

            function endModalDrag() {
                isDragging = false;
                container.style.cursor = 'grab';
            }
        }

        // 모달용 3D 모델 회전 업데이트
        function updateModal3DModelRotation(model) {
            if (model) {
                model.style.transform = `rotateX(${modalRotationX}deg) rotateY(${modalRotationY}deg)`;
            }
        }

        // 모달용 3D 모델 리셋
        function resetModal3DModel() {
            modalRotationX = 0;
            modalRotationY = 0;
            const model = document.getElementById('modal-model-3d');
            if (model) {
                updateModal3DModelRotation(model);
            }
            if (modalAutoRotateInterval) {
                clearInterval(modalAutoRotateInterval);
                modalAutoRotateInterval = null;
                modalAutoRotate = false;
            }
        }

        // 모달용 자동 회전 토글
        function toggleModalAutoRotate() {
            modalAutoRotate = !modalAutoRotate;
            const model = document.getElementById('modal-model-3d');

            if (modalAutoRotate) {
                modalAutoRotateInterval = setInterval(() => {
                    modalRotationY += 2;
                    if (model) {
                        updateModal3DModelRotation(model);
                    }
                }, 50);
            } else {
                if (modalAutoRotateInterval) {
                    clearInterval(modalAutoRotateInterval);
                    modalAutoRotateInterval = null;
                }
            }
        }

        // 모달 닫기
        function closeModal() {
            const modal = document.getElementById('modal');
            modal.style.display = 'none';

            if (modalAutoRotateInterval) {
                clearInterval(modalAutoRotateInterval);
                modalAutoRotateInterval = null;
                modalAutoRotate = false;
            }
            modalRotationX = 0;
            modalRotationY = 0;

            const modalContent = document.getElementById('modalContent');
            if (modalContent) {
                modalContent.innerHTML = '';
            }
        }

        // 책 전환
        function switchBook(bookType) {
            document.querySelectorAll('.book-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            if (bookType === 'friender') {
                document.getElementById('friender-btn').classList.add('active');
            } else {
                document.getElementById('vq-btn').classList.add('active');
            }

            if (bookType === 'friender') {
                bookData = frienderData;
            } else {
                bookData = vqData;
            }

            totalPages = bookData.totalPages;
            currentPage = 0;
            renderBook();
            updateNavigation();
            startCoverAnimation();
        }

        // PDF 프린트
        function printPDF() {
            const pdfUrl = bookData.pdfPath;
            const printWindow = window.open(pdfUrl, '_blank');

            if (printWindow) {
                printWindow.onload = () => {
                    printWindow.print();
                };
            }
        }

        // PDF 다운로드
        function downloadPDF() {
            const link = document.createElement('a');
            link.href = bookData.pdfPath;
            link.download = bookData.name + '.pdf';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // 책자 다운로드
        function downloadBook(bookType) {
            let pdfUrl = '';
            let fileName = '';

            if (bookType === 'friender') {
                pdfUrl = frienderData.pdfPath;
                fileName = frienderData.name + '.pdf';
            } else if (bookType === 'vq') {
                pdfUrl = vqData.pdfPath;
                fileName = vqData.name + '.pdf';
            }

            if (pdfUrl) {
                const link = document.createElement('a');
                link.href = pdfUrl;
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // 초기화 실행
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>